<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>دكور ليزر وحلويات</title>
<style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:#000;color:#fff;font-family:Arial;min-height:100vh;background:linear-gradient(135deg,#111,#000);}
    .top-bar{position:fixed;top:0;left:0;right:0;height:65px;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.9);backdrop-filter:blur(12px);z-index:999;border-bottom:2px solid #d4af37;}
    .lang-btn{background:#d4af37;color:#000;padding:10px 25px;border-radius:50px;font-weight:bold;font-size:1.1rem;cursor:pointer;}
    .wa-btn{position:fixed;top:12px;left:15px;width:52px;height:52px;background:#25D366;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;z-index:1000;}
    .admin-icon{position:fixed;top:15px;right:15px;font-size:30px;opacity:0.3;cursor:pointer;z-index:1000;}
    .back-btn{position:fixed;top:80px;left:15px;background:#d4af37;color:#000;padding:10px 18px;border-radius:50px;font-weight:bold;z-index:998;display:none;}

    header{text-align:center;padding:90px 20px 30px;background:linear-gradient(rgba(0,0,0,0.8),rgba(0,0,0,0.8)),url('https://images.unsplash.com/photo-1518770660439-24edd4c565f7');background-size:cover;background-position:center;}
    h1{font-size:2.4rem;color:#d4af37;margin:15px 0;}
    p{font-size:1.2rem;max-width:90%;margin:15px auto;}

    .folders{display:flex;justify-content:center;gap:30px;flex-wrap:wrap;padding:20px;}
    .folder{cursor:pointer;width:140px;height:140px;background:rgba(212,175,55,0.15);border:2px solid #d4af37;border-radius:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:0.4s;box-shadow:0 6px 20px rgba(212,175,55,0.3);}
    .folder:hover{transform:translateY(-10px);background:rgba(212,175,55,0.25);}
    .folder i{font-size:50px;color:#d4af37;margin-bottom:10px;}
    .folder span{font-weight:bold;font-size:1.1rem;}

    .content{display:none;padding:20px 15px;}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:15px;}
    .grid .item{position:relative;border-radius:15px;overflow:hidden;box-shadow:0 8px 20px rgba(212,175,55,0.3);}
    .grid img{width:100%;height:220px;object-fit:cover;cursor:pointer;transition:0.3s;}
    .grid img:hover{transform:scale(1.05);}
    .cap{background:rgba(212,175,55,0.95);color:#000;padding:10px;font-weight:bold;text-align:center;}
    .del{position:absolute;top:8px;left:8px;background:#e74c3c;color:#fff;width:38px;height:38px;border-radius:50%;display:none;align-items:center;justify-content:center;font-size:22px;cursor:pointer;}
    .vid-grid{grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;}
    .vid-grid iframe{width:100%;height:220px;border-radius:15px;}

    #lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);display:none;align-items:center;justify-content:center;z-index:9999;}
    #lightbox.active{display:flex;}
    #lightbox img{max-width:95%;max-height:95vh;object-fit:contain;border-radius:15px;box-shadow:0 0 40px rgba(212,175,55,0.6);}

    #adminpanel{background:#111;border:3px solid #d4af37;padding:25px;border-radius:20px;margin:20px 15px;display:none;z-index:998;}
    #adminpanel input,#adminpanel button{width:100%;padding:14px;margin:12px 0;border-radius:12px;}
    #adminpanel input{background:#333;color:#fff;border:none;}
    #adminpanel button{background:#d4af37;color:#000;font-weight:bold;}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<div class="top-bar"><div class="lang-btn" onclick="toggleLang()">عربي / Español</div></div>
<a href="https://wa.me/34644170829" class="wa-btn"><i class="fab fa-whatsapp"></i></a>
<div class="admin-icon" id="adminIcon">⚙️</div>
<div class="back-btn" onclick="goBack()">رجوع</div>

<header>
    <h1>مرحبا في عالم الدكور بالليزر والحلويات</h1>
    <p>كل يوم تصاميم جديدة للحفلات والمناسبات</p>
</header>

<!-- الصفحة الرئيسية -->
<div id="home">
    <div class="folders">
        <div class="folder" onclick="showPage('photos')">
            <i class="fas fa-images"></i>
            <span>الصور</span>
        </div>
        <div class="folder" onclick="showPage('videos')">
            <i class="fas fa-video"></i>
            <span>الفيديوهات</span>
        </div>
    </div>
</div>

<!-- صفحة الصور -->
<div class="content" id="photos">
    <h2 style="color:#d4af37;text-align:center;margin:20px;">كل الصور</h2>
    <div class="grid" id="photoContainer"></div>
</div>

<!-- صفحة الفيديوهات -->
<div class="content" id="videos">
    <h2 style="color:#d4af37;text-align:center;margin:20px;">كل الفيديوهات</h2>
    <div class="vid-grid" id="videoContainer"></div>
</div>

<!-- Lightbox -->
<div id="lightbox" onclick="closeLightbox()">
    <img id="bigImg" src="" alt="">
</div>

<!-- لوحة الأدمن -->
<div id="adminpanel">
    <h3 style="color:#d4af37;text-align:center;">إضافة صورة</h3>
    <input type="file" id="newimg" accept="image/*"><br>
    <input type="text" id="capimg" placeholder="تعليق (اختياري)"><br>
    <button onclick="addImg()">إضافة الصورة</button>

    <h3 style="color:#d4af37;text-align:center;margin-top:20px;">إضافة فيديو يوتيوب</h3>
    <input type="text" id="newvid" placeholder="رابط يوتيوب كامل"><br>
    <input type="text" id="capvid" placeholder="تعليق (اختياري)"><br>
    <button onclick="addVid()">إضافة الفيديو</button>
</div>

<script>
// البيانات الافتراضية (كمثال)
const defaultData = {
    photos: [
        {id: 1, src: 'images.unsplash.com', cap: 'ديكور حفل زفاف'},
        {id: 2, src: 'images.unsplash.com', cap: 'حلويات العيد'},
    ],
    videos: [
        {id: 1, src: 'www.youtube.com', cap: 'فيديو تعريفي 1'},
    ]
};

// متغير لمعرفة أين نحن الآن
let currentView = 'home';
let adminMode = false;

// إظهار صفحة معينة
function showPage(page){
    document.getElementById('home').style.display = 'none';
    document.getElementById(page).style.display = 'block';
    document.querySelector('.back-btn').style.display = 'block';
    currentView = page;
    if(page==='photos') loadPhotos();
    if(page==='videos') loadVideos();
    history.pushState({page: page}, '');
}

// الرجوع
function goBack(){
    document.getElementById('home').style.display = 'block';
    document.getElementById('photos').style.display = 'none';
    document.getElementById('videos').style.display = 'none';
    document.querySelector('.back-btn').style.display = 'none';
    closeLightbox();
    currentView = 'home';
}

// زر الرجوع في الهاتف (الأهم!)
window.addEventListener('popstate', function(){
    if(currentView === 'lightbox'){
        closeLightbox();
    } else if(currentView === 'photos' || currentView === 'videos'){
        goBack();
    }
});

// تكبير الصور
function openLightbox(src){
    document.getElementById('bigImg').src = src;
    document.getElementById('lightbox').classList.add('active');
    currentView = 'lightbox';
    history.pushState({page: 'lightbox'}, '');
}
function closeLightbox(){
    document.getElementById('lightbox').classList.remove('active');
    document.getElementById('bigImg').src = '';
    currentView = document.getElementById('photos').style.display==='block' ? 'photos' : 'videos';
}

// الأدمن (اضغطي مطول على ⚙️)
let pressTimer;
document.getElementById('adminIcon').addEventListener('touchstart', e=>{e.preventDefault();pressTimer=setTimeout(openAdmin,1000);});
document.getElementById('adminIcon').addEventListener('mousedown', e=>{e.preventDefault();pressTimer=setTimeout(openAdmin,1000);});
document.getElementById('adminIcon').addEventListener('touchend', ()=>clearTimeout(pressTimer));
document.getElementById('adminIcon').addEventListener('mouseup', ()=>clearTimeout(pressTimer));

function openAdmin(){
    if(prompt("الكود السري:")==="1234"){
        document.getElementById('adminpanel').style.display="block";
        document.querySelectorAll('.del').forEach(d=>d.style.display="flex");
        adminMode = true;
        alert("♥ تم يا قمر ♥");
    }
}

// تحميل الصور من التخزين المحلي وعرضها
function loadPhotos(){
    let data = JSON.parse(localStorage.getItem('laserData') || JSON.stringify(defaultData));
    const container = document.getElementById('photoContainer');
    container.innerHTML = '';
    data.photos.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
            <img src="${item.src}" alt="${item.cap}" onclick="openLightbox('${item.src}')">
            <div class="cap">${item.cap}</div>
            <div class="del" onclick="deleteItem('photos', ${item.id})">❌</div>
        `;
        container.appendChild(div);
    });
    // أظهر أزرار الحذف إذا كان وضع الأدمن مفعلاً
    if (adminMode) {
        document.querySelectorAll('#photoContainer .del').forEach(d => d.style.display = 'flex');
    }
}

// تحميل الفيديوهات من التخزين المحلي وعرضها
function loadVideos(){
    let data = JSON.parse(localStorage.getItem('laserData') || JSON.stringify(defaultData));
    const container = document.getElementById('videoContainer');
    container.innerHTML = '';
    data.videos.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
            <iframe src="${item.src.replace("watch?v=", "embed/")}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <div class="cap">${item.cap}</div>
            <div class="del" onclick="deleteItem('videos', ${item.id})">❌</div>
        `;
        container.appendChild(div);
    });
     if (adminMode) {
        document.querySelectorAll('#videoContainer .del').forEach(d => d.style.display = 'flex');
    }
}


// **الوظيفة التي كانت ناقصة (إضافة صورة)**
function addImg(){
    const fileInput = document.getElementById('newimg');
    const capInput = document.getElementById('capimg');
    const file = fileInput.files[0];

    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const src = e.target.result; // الصورة بصيغة Base64
            let data = JSON.parse(localStorage.getItem('laserData') || JSON.stringify(defaultData));
            const newId = Date.now(); // معرف فريد جديد
            data.photos.push({id: newId, src: src, cap: capInput.value || 'صورة جديدة'});
            localStorage.setItem('laserData', JSON.stringify(data));
            
            // تحديث العرض إذا كنا في صفحة الصور
            if (currentView === 'photos') {
                loadPhotos();
            }
            alert('تمت إضافة الصورة بنجاح!');
            capInput.value = '';
            fileInput.value = '';
        };
        reader.readAsDataURL(file); // تحويل الملف إلى Base64
    } else {
        alert('الرجاء اختيار ملف صورة!');
    }
}

// وظيفة إضافة فيديو
function addVid(){
    const urlInput = document.getElementById('newvid');
    const capInput = document.getElementById('capvid');
    const url = urlInput.value;

    if (url && url.includes('youtube.com')) {
        let data = JSON.parse(localStorage.getItem('laserData') || JSON.stringify(defaultData));
        const newId = Date.now();
        data.videos.push({id: newId, src: url, cap: capInput.value || 'فيديو جديد'});
        localStorage.setItem('laserData', JSON.stringify(data));

        if (currentView === 'videos') {
            loadVideos();
        }
        alert('تمت إضافة الفيديو بنجاح!');
        urlInput.value = '';
        capInput.value = '';
    } else {
        alert('الرجاء إدخال رابط يوتيوب صالح!');
    }
}

// وظيفة حذف عنصر (صورة أو فيديو)
function deleteItem(type, id){
    if (confirm('هل أنت متأكد من حذف هذا العنصر؟')) {
        let data = JSON.parse(localStorage.getItem('laserData') || JSON.stringify(defaultData));
        data[type] = data[type].filter(item => item.id !== id);
        localStorage.setItem('laserData', JSON.stringify(data));
        
        if (type === 'photos') loadPhotos();
        if (type === 'videos') loadVideos();
    }
}

// وظيفة تبديل اللغة (غير مكتملة في الكود الأصلي لكن الزر موجود)
function toggleLang() {
    alert("وظيفة تغيير اللغة غير مبرمجة بعد في هذا الكود.");
}

// تحميل الصور عند بدء التشغيل لأول مرة
loadPhotos(); 

</script>
</body>
</html>
